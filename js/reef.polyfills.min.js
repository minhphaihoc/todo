/*! reef v0.2.2 | (c) 2018 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/reef */
Array.prototype.find||(Array.prototype.find=function(t){if(null===this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("callback must be a function");for(var r=arguments[1],o=0;o<n;){var a=e[o];if(t.call(r,a,o,e))return a;o++}}),Array.from||(Array.from=(function(){var t=Object.prototype.toString,e=function(e){return"function"==typeof e||"[object Function]"===t.call(e)},n=function(t){var e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(e>0?1:-1)*Math.floor(Math.abs(e)):e},r=Math.pow(2,53)-1,o=function(t){var e=n(t);return Math.min(Math.max(e,0),r)};return function(t){var n=this,r=Object(t);if(null===t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var a,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!e(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(a=arguments[2])}for(var f,c=o(r.length),u=e(n)?Object(new n(c)):new Array(c),h=0;h<c;)f=r[h],u[h]=i?void 0===a?i(f,h):i.call(a,f,h):f,h+=1;return u.length=c,u}})()),(function(t){for(var e=0;e<t.length;e++)!window[t[e]]||"remove"in window[t[e]].prototype||(window[t[e]].prototype.remove=function(){this.parentNode.removeChild(this)})})(["Element","CharacterData","DocumentType"]),(function(t,e){"function"==typeof define&&define.amd?define([],(function(){return e(t)})):"object"==typeof exports?module.exports=e(t):t.Reef=e(t)})("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,(function(t){"use strict";var e,n=["for"],r=function(){if(!Array.from||!t.DOMParser)return!1;e=e||new DOMParser;try{e.parseFromString("x","text/html")}catch(t){return!1}return!0},o=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},a=function(t){if(t)return JSON.parse(JSON.stringify(t))},i=function(t,e){if(!r())throw new Error("Reef.js is not supported by this browser.");if(!(t||e&&e.lagoon))throw new Error("Reef.js: You did not provide an element to make into a component.");if(!(e&&(e.template||e&&e.lagoon)))throw new Error("Reef.js: You did not provide a template for this component.");if(this.elem=t,this.data=e.data,this.template=e.template,this.attached=[],this.lagoon=e.lagoon,e.attachTo){var n=this;e.attachTo.forEach((function(t){"attach"in t&&t.attach(n)}))}},f=function(t){return"data-"===t.slice(0,5)||n.indexOf(t)>-1},c=function(t,e){e.forEach((function(e){"class"===e.att?t.className=e.value:f(e.att)?t.setAttribute(e.att,e.value):t[e.att]=e.value}))},u=function(t,e){e.forEach((function(e){"class"===e.att?t.className="":t.removeAttribute(e.att)}))},h=function(t){return Array.from(t).map((function(t){return{att:t.name,value:t.value}}))},d=function(t){var e="text"===t.type?document.createTextNode(t.content):document.createElement(t.type);return c(e,t.atts),t.children.length>0?t.children.forEach((function(t){e.appendChild(d(t))})):"text"!==t.type&&(e.textContent=t.content),e},s=function(t,e){var n=e.atts.filter((function(e){return void 0===t.atts.find((function(t){return e.att===t.att}))})),r=t.atts.filter((function(t){var n=e.atts.find((function(e){return t.att===e.att}));return void 0===n||n.value!==t.value}));c(e.node,r),u(e.node,n)},l=function(t,e,n,r){var o=e.length-t.length;if(o>0)for(;o>0;o--)e[e.length-o].node.remove();t.forEach((function(o,a){return e[a]?t[a].type!==e[a].type?void e[a].node.parentNode.replaceChild(d(t[a]),e[a].node):(s(t[a],e[a],e[a].node),void(r.filter((function(t){return 3!==o.node.nodeType&&o.node.matches(t)})).length>0||(t[a].content!==e[a].content&&(e[a].node.textContent=t[a].content),o.children.length>0&&l(o.children,e[a].children||[],e[a].node,r)))):void n.appendChild(d(t[a]))}))},p=function(t){var e=[];return Array.from(t.childNodes).forEach((function(t){e.push({content:t.childNodes&&t.childNodes.length>0?null:t.textContent,atts:3===t.nodeType?[]:h(t.attributes),type:3===t.nodeType?"text":t.tagName.toLowerCase(),children:p(t),node:t})})),e},y=function(t){return e=e||new DOMParser,e.parseFromString(t,"text/html").body},m=function(t,e){t&&t.forEach((function(t){if(t.attached.indexOf(e)>-1)throw new Error("ReefJS: "+e.elem+" has attached nodes that it is also attached to, creating an infinite loop.");"render"in t&&t.render()}))};return i.prototype.render=function(){if(this.lagoon)return void m(this.attached,this);if(!this.template)throw new Error("Reef.js: No template was provided.");var e="string"==typeof this.elem?document.querySelector(this.elem):this.elem;if(!e)throw new Error("Reef.js: The DOM element to render your template into was not found.");var n="function"==typeof this.template?this.template(a(this.data)):this.template;if(-1!==["string","number"].indexOf(typeof n)){var r=p(y(n),i),o=p(e,i),i=this.attached.map((function(t){return t.elem}));if(l(r,o,e,i),"function"==typeof t.CustomEvent){var f=new CustomEvent("render",{bubbles:!0});e.dispatchEvent(f)}return m(this.attached,this),e}},i.prototype.getData=function(){return a(this.data)},i.prototype.setData=function(t){if("object"!==o(t))throw new Error("ReefJS: The provided data is not an object.");for(var e in t)t.hasOwnProperty(e)&&(this.data[e]=t[e]);this.render()},i.addAttributes=function(t){"array"===o(t)?Array.prototype.push.apply(n,t):n.push(t)},i.removeAttributes=function(t){var e="array"===o(t);n=n.filter((function(n){return e?-1===t.indexOf(n):n!==t}))},i.prototype.attach=function(t){"array"===o(t)?Array.prototype.push.apply(this.attached,t):this.attached.push(t)},i.prototype.detach=function(t){var e="array"===o(t);this.attached=this.attached.filter((function(n){return e?-1===t.indexOf(n):n!==t}))},i}));